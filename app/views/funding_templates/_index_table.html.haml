:ruby
  table_dom_id = SecureRandom.hex
  show_actions ||= 0


#table_actions.btn-group
  - if can? :create, FundingTemplate
    = link_to new_funding_template_path(:funding_source_id => @funding_source.try(:id)), :class => 'btn btn-default' do
      %i.fa.fa-plus.fa-fw
      = "Add Template"
  - if show_actions == 1
    = render :partial => "funding_templates/index_actions"

%table.table.table-hover{:id => table_dom_id, :data => {:toggle => 'table',
  :pagination => 'true',
  :show_pagination_switch => 'true',
  :page_list => "[5, 10, 20, 50, 100, 200]",
  :page_size => current_user.num_table_rows,
  :search => 'false',
  :toolbar => "#table_actions",
  :export_types => "['csv', 'txt', 'excel']",
  :show_export => 'true',
  :show_columns => 'true',
  :show_toggle => 'true'}}

  %thead
    %tr
      %th.center{:data => {:visible => 'false'}} Object Key
      %th.center{:data => {:sortable => 'true'}} Program
      %th.center{:data => {:sortable => 'true'}} Name

      %th.center{:data => {:sortable => 'true'}} Contributer
      %th.center{:data => {:sortable => 'true'}} Transfer
      %th.center{:data => {:sortable => 'true'}} Owner

      - FundingTemplateType.active.each do |type|
        %th.center{:data => {:sortable => 'true'}}= type.name

      %th.center{:data => {:sortable => 'true'}} Recurring
      %th.center{:data => {:sortable => 'true', :formatter => 'percentage_formatter'}} Percentage Match

      %th

  %tbody
    - funding_templates.each do |f|
      %tr{:id => f.object_key, :class => 'action-path'}
        %td.left= f.object_key
        %td.left= f.funding_source.to_s
        %td.left= f.name

        %td.left= f.contributer.to_s
        %td.center= format_as_boolean(f.transfer_only)
        %td.left= f.owner.to_s

        - FundingTemplateType.active.each do |type|
          %td.center= f.funding_template_types.include?(type) ? format_as_boolean(true) : ''

        %td.center= format_as_boolean(f.recurring)
        %td.right= format_as_decimal(f.match_required, 3)

        %td.center.nowrap
          %a.transam-popover{data: {placement: 'left', toggle: 'popover', html: 'true', content: f.description}, title: 'Description', tabindex: '0'}
            %i.fa.fa-info-circle
          - if can? :update, f
            = link_to edit_funding_template_path(f), :class => "button btn-xs", :remote => true, :title => "Edit template" do
              %i.fa.fa-edit.fa-1-5x.text-success
            - if can? :destroy, f
              = link_to funding_template_path(f), :method => :delete, :data => {:confirm => "This template is associated with XXX buckets, which are tagged to YYY projects. Are you sure? The action cannot be undone."}  do
                %i.fa.fa-trash-o.fa-fw.text-danger

= render :partial => 'shared/table_scripts', :locals => {:table_id => table_dom_id, :path_pattern => funding_template_path("xxx")}

:javascript

  $('#' + '#{table_dom_id}').on('click-row.bs.table', function (e, row, $element) {
    var url = path.replace("x", row['object_key']);
    document.location.href = url;
  }).on('post-body.bs.table', function () {
    $('.transam-popover').popover({
      trigger: 'hover'
    });

    $('.transam-tooltip').tooltip();
  });