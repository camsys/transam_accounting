= simple_form_for(@funding_template,
  :html => {:class => 'form-vertical funding_template_form' },
  :wrapper => :vertical_form,
  :wrapper_mappings => {:check_boxes => :vertical_radio_and_checkboxes, :radio_buttons => :vertical_radio_and_checkboxes, :file => :vertical_file_input, :boolean => :vertical_boolean}) do |f|

  .col-md-6
    = dialog_tag('Details', {:icon => 'fa fa-book', :class => "header-part"}) do

      = f.association :funding_source, :required => true, :collection => FundingSource.active, :include_blank => true, :label => "Funding Program", :disabled => !@funding_template.new_record?
      = f.input :name, :required => true, :input_html => {:maxlength => 64}
      = f.input :external_id, :label => 'dotGrants ID', :input_html => {:maxlength => 32}
      = f.input :description

      .row
        .col-sm-6
          = f.association :contributor, :collection => FundingSourceType.contributor.active, :required => true, :disabled => !@funding_template.new_record?
        .col-sm-6
          = f.association :owner, :collection => FundingSourceType.owner.active, :required => true, :disabled => !@funding_template.new_record?

      .row
        .col-sm-3
          = f.input :recurring
        .col-sm-3
          = f.input :transfer_only

      .row
        .col-sm-6
          = f.input :match_required, :label => 'Pcnt Match', :wrapper => :vertical_append do
            = f.input_field :match_required, :class => 'form-control', :max => 100, :step => 0.001
            %span.input-group-addon
              %i.fa.fa-percent

      = f.association :funding_template_types, :as => :check_boxes, :label => "For"

      = f.input :organization_ids, :as => :hidden

  .col-md-6
    = dialog_tag('Eligibility', {:icon => 'fa fa-book', :class => "header-part"}) do

      = f.input :all_organizations

      #org_select.input-large

  = f.button :submit, 'Save', :class => "btn btn-primary"

= render 'form_scripts'

:javascript

  if($('#funding_template_all_organizations').prop('checked')) {
      $("#org_select").hide();
    } else {
      $("#org_select").show();
    }

  $('#funding_template_all_organizations').change(function() {
    if($(this).prop('checked')) {
      $("#org_select").hide();
    } else {
      $("#org_select").show();
    }
  });

  // jquery validations
  $('.funding_template_form').validate({
    ignore: '#funding_template_organization_ids, .filter-input, .filtered',
    submitHandler: function(form) {
      form.submit();
    }
  });

  $( "#funding_template_match_required" ).rules( "add", {
    greaterThan: 0,
    PercentThreeDigits: true
  });



  $.validator.addMethod('greaterThan', function(value, element, params) {
      return this.optional(element) || parseFloat(value) > params;
  }, "Please enter a value greater than {0}.");

  $.validator.addMethod('PercentThreeDigits', function(value, element) {
      return this.optional(element) || /^\d+(\.\d{0,3})?$/.test(value);
  }, "Please enter a correct percent up to three decimal places.");
